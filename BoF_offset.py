import sys

def generate_string(nb):
    alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
    alphabet_pos = 0
    numbers = '1234567890'
    number_pos = 0
    string = ''
    int_count = -1
    LETTER = True
    NUMBER = False
    for x in range (0, int(nb)):
        if x % 26 == 0 :
            int_count += 1
            alphabet_pos = 0
            if LETTER == True:
                string = string + alphabet[alphabet_pos]
                LETTER = False
            else:
                string = string + str(int_count+1)
                int_count += 1
                LETTER = True
        else:
            if LETTER == True:
                alphabet_pos += 1
                string = string + alphabet[alphabet_pos]
                LETTER = False
            else:
                string = string + str(int_count)
                LETTER = True
    print(string)
    return(string)

def retreive_pos(nb, string):
    identifier = raw_input("EIP Value : 0x")
    if len(identifier) != 8:
        print("The value must be 8 bytes long!")
        retreive_pos(nb, string)
    else: 
        eip = str(identifier[6:]) + str(identifier[4:][:2]) + str(identifier[2:][:2]) + str(identifier[:2])
        eip_decoded = str(eip).decode('hex')
        before_identifier = string.split(eip_decoded)[0]
        #print(before_identifier)
        before_eip = len(before_identifier)
        print("Offset: " + str(before_eip) + " characters.")

if len(sys.argv) != 3:
    print("Generate a unique string in order to find the offset needed for buffer overflow exploitation:")
    print("Usage: ./BoF_Finder.py -n <number of characters to generate>")
    exit(0)

elif sys.argv[1] == "-n":
    nb = sys.argv[2]
    string = generate_string(nb)
    retreive_pos(nb, string)
else:
    print("Usage: ./BoF_Finder.py -n <number of characters to generate>")
    exit(0)
