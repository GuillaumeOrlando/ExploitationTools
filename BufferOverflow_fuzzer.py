import commands
import sys

pr_name = sys.argv[1]

char = "\x41"
iterations_max = 3000

for x in range(0,iterations_max):
        payload = str(char) * int(x)
        output = commands.getstatusoutput('echo ' + str(payload) + ' | ' +  str(pr_name))
        if "Segmentation fault" in str(output):
                print("SEGFAULT found after " + str(x) + " characters.")
                exit(0)
