# PDF password cracker (password policy)

from PyPDF2 import PdfFileReader, PdfFileWriter
import itertools

input_file = "secret.pdf"
output_file = "test.pdf"
lenght = 6
pwd_policy = ["a", "b", "c", "d", "e", "1", "2", "3", "4", "5"]
file = PdfFileReader(input_file)

if file.isEncrypted == True:
    print("[+] Starting cracking process ...")
else:
    print("[-] PDF file is not encrypted")
    exit(1)

for pwd in itertools.product(pwd_policy, repeat = lenght):
    pwd = str(pwd).replace("'","").replace("(","").replace(")","").replace(" ","").replace(",","")
    # print ("[+] Trying password " + str(pwd))
    try:
        file.decrypt(pwd)
        writer = PdfFileWriter()
        for i in range(file.getNumPages()):
            page = file.getPage(i)
            page_content = page.extractText()
            print(page_content)
        print("[+] Password found : " + str(pwd))
        break
    except:
        pass