#!/usr/bin/env python

import pwn

flag = ''
enc_array = []
crack_array = []
full_array = 'abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ{[(#)]}_-\n'

elf = pwn.ELF('main')
p = elf.process()

p.send(full_array)
re = p.recv()

all_char_enc = str(re).split("Here's your ciphertext: ")[1].split("Now quack it! : ")[0].replace("\n", "")
obfuscated = str(re).split("Now quack it! : ")[1].split("That's all folks.")[0].replace("\n", "")

for x in range(0, len(full_array) - 1):
        char_enc = str(all_char_enc).split(" ")[x]
        char_enc = str(char_enc).replace(" ", "")
        enc_array.append(char_enc)

for x in range(0, len(obfuscated)/3 + 1): 
        crack_enc = str(obfuscated).split(" ")[x]
        crack_enc = str(crack_enc).replace(" ", "")
        crack_array.append(crack_enc)
 
x = 0
for elem in crack_array:
    x = 0
    for decoded in enc_array:
        x += 1
        if elem == decoded:
            flag += full_array[x - 1]
            x = 0
print("[+] Flag: " + str(flag))
