# Zip file password cracker

import zipfile

file_name = "secret.zip"
dict_file = "passwords.txt"
file_existance = (zipfile.is_zipfile(file_name))
if str(file_existance) != "True":
    print("[-] Incorrect or wrong filename.")
    exit(1)
archive = zipfile.ZipFile(file_name)
print("[+] " + str(archive.namelist()).replace("[","").replace("]",""))
with open(dict_file) as file:
    passw = file.readlines()
    for elem in passw:
        password = (elem.replace("\n",""))
        #print(password)
        try:
            re = archive.extractall(pwd=password.encode('cp850','replace'))
            print("[+] Password found : " + str(password))
            with open(str(archive.namelist()).replace("[","").replace("]","").replace("'","")) as flag_file:
                flag = str(flag_file.read())
            print("[+] " + flag)
            break
        except:
            pass