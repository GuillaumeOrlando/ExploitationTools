# ZipFile cracker (password policy)

import zipfile
import itertools
from itertools import combinations

file_name = "secret.zip"
lenght = 6
pwd_policy = ["a", "b", "c", "d", "e", "1", "2", "3", "4", "5"]

for pwd in itertools.product(pwd_policy, repeat = lenght):
    pwd = str(pwd).replace("'","").replace("(","").replace(")","").replace(" ","").replace(",","")
    archive = zipfile.ZipFile(file_name)
    print ("[+] Trying password " + str(pwd))
    try:
        archive.extractall(pwd=str(pwd).encode('cp850', 'replace'))
        print("[+] Password found : " + str(pwd))
        break
    except:
        pass