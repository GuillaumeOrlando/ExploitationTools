#/usr/bin/python
# coding=utf-8

import gmpy2
from Crypto.PublicKey import RSA
from multiprocessing import Pool
pool = Pool(4)

#with open('./pubkey.pem', 'r') as f:
#    key = RSA.importKey(f)
#    N = key.n
#e= key.e

N = 102346477809188164149666237875831487276093753138581452189150581288274762371458335130208782251999067431416740623801548745068435494069196452555130488551392351521104832433338347876647247145940791496418976816678614449219476252610877509106424219285651012126290668046420434492850711642394317803367090778362049205437

e = 3

#with open('flag.enc', 'r') as f:
#    cipher = f.read().encode('hex')
#    cipher = int(cipher, 16)

cipher = hex(4458558515804625757984145622008292910146092770232527464448604606202639682157127059968851563875246010604577447368616002300477986613082254856311395681221546841526780960776842385163089662821)

def calc(j):
    print(j)
    a, b = gmpy2.iroot(cipher + j * N, 3)
    if b == 1:
        m = a
        print('{:x}'.format(int(m)).decode('hex'))
        pool.terminate()
        exit()

def SmallE():
    inputs = range(0, 130000000)
    pool.map(calc, inputs)
    pool.close()
    pool.join()

if __name__ == '__main__':
    print('start')
    SmallE ()
